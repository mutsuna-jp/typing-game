# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆï¼šãƒ•ãƒªãƒƒã‚¯å…¥åŠ›ãƒ¢ãƒ¼ãƒ‰ã®ãƒãƒ¼ãƒˆå¯¾ç­–å®Ÿè£…

## æ¦‚è¦
ãƒ•ãƒªãƒƒã‚¯å…¥åŠ›ãƒ¢ãƒ¼ãƒ‰ï¼ˆã²ã‚‰ãŒãªå…¥åŠ›ï¼‰ã®ãƒãƒ¼ãƒˆå¯¾ç­–ã‚’å®Ÿè£…ã—ã¾ã—ãŸã€‚ã“ã‚Œã«ã‚ˆã‚Šã€åŠè§’å…¥åŠ›ãƒ¢ãƒ¼ãƒ‰ã¨åŒç­‰ãƒ¬ãƒ™ãƒ«ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãŒç¢ºä¿ã•ã‚Œã¾ã™ã€‚

## å®Ÿè£…å†…å®¹

### 1. å…¥åŠ›ãƒ¢ãƒ¼ãƒ‰æ¤œå‡º (+page.server.ts)
```typescript
const isFlickMode = keyLog.some((k) => /^[\u3041-\u3096]+$/.test(k.key));
```
- ã‚­ãƒ¼ãƒ­ã‚°ã®å†…å®¹ã‹ã‚‰ã€ãƒ•ãƒªãƒƒã‚¯å…¥åŠ›ï¼ˆã²ã‚‰ãŒãªï¼‰ã‹åŠè§’å…¥åŠ›ï¼ˆãƒ­ãƒ¼ãƒå­—ï¼‰ã‹ã‚’è‡ªå‹•åˆ¤å®š
- å…¥åŠ›ãƒ¢ãƒ¼ãƒ‰æ··åˆã®æ¤œå‡º

### 2. ã‚­ãƒ¼ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ¤œè¨¼ (+page.server.ts)
```typescript
// ã™ã¹ã¦ã®ã‚­ãƒ¼ãŒã²ã‚‰ãŒãªã¾ãŸã¯ãƒ­ãƒ¼ãƒå­—ã®ã„ãšã‚Œã‹ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª
// æ··åˆå…¥åŠ›ã‚„ä¸æ­£ãªæ–‡å­—åˆ—ã‚’æ¤œå‡º
```
- å„ã‚­ãƒ¼ãŒã²ã‚‰ãŒãªï¼ˆ`\u3041-\u3096`ï¼‰ã¾ãŸã¯ãƒ­ãƒ¼ãƒå­—ï¼ˆ`a-z`, `-`ï¼‰ã®ã„ãšã‚Œã‹ã§ã‚ã‚‹ã“ã¨ã‚’æ¤œè¨¼
- æ··åˆå…¥åŠ›ï¼ˆãƒ•ãƒªãƒƒã‚¯+åŠè§’ï¼‰ã®æ¤œå‡ºã¨æ‹’å¦
- ä¸æ­£ãªæ–‡å­—åˆ—ã®æ¤œå‡º

### 3. ãƒ•ãƒªãƒƒã‚¯å…¥åŠ›ã®å†ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ (+page.server.ts)
```typescript
if (isFlickMode) {
  // Flick mode: key is hiragana, use it directly
  processedKey = key;
  
  const currToken = tokens[tokenIndex];
  if (currToken === processedKey) {
    // Exact match - perfect flick input
    correctKeys++;
    tokenIndex++;
  } else {
    // Hiragana mismatch - wrong key
    hasErrorInWord = true;
    break;
  }
}
```
- ã‚µãƒ¼ãƒãƒ¼å´ã§å…¥åŠ›ã•ã‚ŒãŸã²ã‚‰ãŒãªãŒã€å®Ÿéš›ã®å˜èªãƒˆãƒ¼ã‚¯ãƒ³ã¨ä¸€è‡´ã—ã¦ã„ã‚‹ã‹ã‚’æ¤œè¨¼
- ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§æ”¹ã–ã‚“ã•ã‚ŒãŸã‚­ãƒ¼ãƒ­ã‚°ã‚’æ¤œå‡º

### 4. ãƒœãƒƒãƒˆæ¤œå‡ºãƒ­ã‚¸ãƒƒã‚¯å¼·åŒ– (+page.server.ts)

#### a. å…¥åŠ›é–“éš”ã®çµ±è¨ˆåˆ†æ
- å…¥åŠ›é–“éš”ã®åˆ†æ•£ã‚’è¨ˆç®—ï¼ˆ`variance >= 2` ã‚’è¦æ±‚ï¼‰
- äººé–“ã‚‰ã—ã„å…¥åŠ›ã®ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ãŒã‚ã‚‹ã“ã¨ã‚’ç¢ºèª
- å®Œå…¨ã«è¦å‰‡çš„ãªå…¥åŠ›ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¤œå‡ºãƒ»æ‹’å¦

#### b. ãƒãƒ¼ã‚¹ãƒˆå…¥åŠ›æ¤œå‡º
```typescript
// ç¬æ™‚å…¥åŠ›ï¼ˆ0msé–“éš”ï¼‰ãŒ5%ä»¥ä¸‹ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª
const bursts = intervals.filter((v) => v === 0).length;
if (bursts > keyLog.length * 0.05) {
  // ä¸æ­£æ¤œå‡º
}
```

#### c. ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡º
```typescript
// å…¥åŠ›é–“éš”ãŒå®Œå…¨ã«è¦å‰‡çš„ã§ãªã„ã“ã¨ã‚’ç¢ºèª
const patternMatch = validIntervals.filter((v) => Math.abs(v - modeInterval) < 5).length;
if (patternMatch > validIntervals.length * 0.9) {
  // ä¸æ­£æ¤œå‡º
}
```

### 5. ãƒ•ãƒªãƒƒã‚¯å›ºæœ‰ã®æ¤œè¨¼ (+page.server.ts)
```typescript
// In flick mode, one key = one token (perfect 1:1 match)
// ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ã‚­ãƒ¼æ•°ãŒäºˆæœŸã•ã‚Œã‚‹æ•°ã‚ˆã‚Šå¤§å¹…ã«å°‘ãªã„å ´åˆã€ä¸æ­£ã‚’æ¤œå‡º
if (keyLog.length < totalTokens * 0.8) {
  // ä¸æ­£æ¤œå‡º
}
```

## æ¤œè¨¼ãƒ•ãƒ­ãƒ¼

### ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰æ¤œè¨¼ã®é †åºï¼ˆ[+page.server.ts](src/routes/%2Bpage.server.ts)ï¼‰
1. **ã‚»ãƒƒã‚·ãƒ§ãƒ³ç¢ºèª** â†’ æœ‰åŠ¹ãªã‚²ãƒ¼ãƒ ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‹ç¢ºèª
2. **å…¥åŠ›ãƒ¢ãƒ¼ãƒ‰æ¤œå‡º** â†’ ãƒ•ãƒªãƒƒã‚¯/åŠè§’ã‚’åˆ¤å®š
3. **ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ¤œè¨¼** â†’ ã‚­ãƒ¼å½¢å¼ã®æ­£å½“æ€§ã‚’ç¢ºèª
4. **å˜èªæ¤œè¨¼** â†’ ã‚·ãƒ¼ãƒ‰åŒæœŸã§æ­£ã—ã„å˜èªãƒªã‚¹ãƒˆã‹ç¢ºèª
5. **ã‚­ãƒ¼ãƒ­ã‚°å†ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³** â†’ å…¥åŠ›ãƒ¢ãƒ¼ãƒ‰ã«å¿œã˜ã¦å‡¦ç†
   - **ãƒ•ãƒªãƒƒã‚¯**: ã²ã‚‰ãŒãª â†’ ãƒˆãƒ¼ã‚¯ãƒ³ç›´æ¥æ¯”è¼ƒ
   - **åŠè§’**: ãƒ­ãƒ¼ãƒå­— â†’ KanaEngineãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°
6. **ã‚¹ã‚³ã‚¢æ¤œè¨¼** â†’ ã‚µãƒ¼ãƒãƒ¼è¨ˆç®—ã‚¹ã‚³ã‚¢ã¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¹ã‚³ã‚¢ãŒä¸€è‡´
7. **å…¥åŠ›é€Ÿåº¦æ¤œè¨¼** â†’ KPM <= 1200 (äººé–“ã®é™ç•Œ)
8. **ãƒœãƒƒãƒˆæ¤œå‡º** â†’ å…¥åŠ›ãƒ‘ã‚¿ãƒ¼ãƒ³ã®çµ±è¨ˆåˆ†æ
   - é–“éš”ã®åˆ†æ•£ >= 2msÂ²
   - ç¬æ™‚å…¥åŠ› <= 5%
   - ãƒ‘ã‚¿ãƒ¼ãƒ³ä¸€è‡´åº¦ <= 90%
9. **ãƒ•ãƒªãƒƒã‚¯å›ºæœ‰æ¤œè¨¼** â†’ ã‚­ãƒ¼æ•°ãŒãƒˆãƒ¼ã‚¯ãƒ³æ•°ã¨æ•´åˆ

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åº¦

### åŠè§’å…¥åŠ›ãƒ¢ãƒ¼ãƒ‰ï¼ˆå¾“æ¥ï¼‰
âœ… å®Œå…¨ãªãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ™ãƒ¼ã‚¹æ¤œè¨¼
âœ… ãƒœãƒƒãƒˆæ¤œå‡ºï¼ˆçµ±è¨ˆåˆ†æï¼‰
âœ… ã‚¹ã‚³ã‚¢æ¤œè¨¼

### ãƒ•ãƒªãƒƒã‚¯å…¥åŠ›ãƒ¢ãƒ¼ãƒ‰ï¼ˆæ–°ï¼‰
âœ… ã²ã‚‰ãŒãªãƒˆãƒ¼ã‚¯ãƒ³ç›´æ¥æ¯”è¼ƒ
âœ… ã‚­ãƒ¼ãƒ­ã‚°ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ¤œè¨¼
âœ… å…¥åŠ›ãƒ¢ãƒ¼ãƒ‰æ··åˆæ¤œå‡º
âœ… å¼·åŒ–ã•ã‚ŒãŸãƒœãƒƒãƒˆæ¤œå‡º
âœ… ãƒ•ãƒªãƒƒã‚¯å›ºæœ‰ã®ä¸€è²«æ€§æ¤œè¨¼
âœ… ã‚¹ã‚³ã‚¢æ¤œè¨¼

## æ”¹ã–ã‚“æ¤œå‡ºäº‹ä¾‹

### ã‚·ãƒŠãƒªã‚ª1: ä¿®æ­£ã•ã‚ŒãŸã‚­ãƒ¼ãƒ­ã‚°ã®æå‡º
**æ”»æ’ƒ**: æ­£ã—ããªã„ã²ã‚‰ãŒãªã‚’ã‚­ãƒ¼ãƒ­ã‚°ã«å«ã‚ã‚‹
**æ¤œå‡º**: ãƒ•ãƒªãƒƒã‚¯å†ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ™‚ã«ã€Œãƒˆãƒ¼ã‚¯ãƒ³ã¨ä¸€è‡´ã—ãªã„ã€ã§æ¤œå‡º

### ã‚·ãƒŠãƒªã‚ª2: ãƒœãƒƒãƒˆãƒ„ãƒ¼ãƒ«ä½¿ç”¨
**æ”»æ’ƒ**: æ©Ÿæ¢°çš„ã«å®Œå…¨ã«ç­‰é–“éš”ã§å…¥åŠ›
**æ¤œå‡º**: ãƒœãƒƒãƒˆæ¤œå‡ºãƒ­ã‚¸ãƒƒã‚¯ã®åˆ†æ•£ãƒã‚§ãƒƒã‚¯ï¼ˆvariance < 2ï¼‰ã§æ¤œå‡º

### ã‚·ãƒŠãƒªã‚ª3: å…¥åŠ›ãƒ¢ãƒ¼ãƒ‰æ··åˆ
**æ”»æ’ƒ**: ãƒ•ãƒªãƒƒã‚¯ã¨åŠè§’ã®æ··åˆå…¥åŠ›
**æ¤œå‡º**: ã‚­ãƒ¼ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ¤œè¨¼ã§å…¥åŠ›ãƒ¢ãƒ¼ãƒ‰æ··åˆã‚’æ¤œå‡º

### ã‚·ãƒŠãƒªã‚ª4: ãƒˆãƒ¼ã‚¯ãƒ³æ•°ã‚ˆã‚Šå°‘ãªã„ã‚­ãƒ¼
**æ”»æ’ƒ**: ã‚¹ã‚­ãƒƒãƒ—ã—ã¦å®Ÿéš›ã‚ˆã‚Šå°‘ãªã„ã‚­ãƒ¼ã§é€ä¿¡
**æ¤œå‡º**: ãƒ•ãƒªãƒƒã‚¯å›ºæœ‰æ¤œè¨¼ã§ã€ŒkeyLog.length < totalTokens * 0.8ã€ã‚’æ¤œå‡º

## ãƒ†ã‚¹ãƒˆæ–¹æ³•

### ãƒ•ãƒªãƒƒã‚¯å…¥åŠ›ãƒ¢ãƒ¼ãƒ‰ã®æ¤œè¨¼ãƒ†ã‚¹ãƒˆ
```bash
# ã‚²ãƒ¼ãƒ é–‹å§‹æ™‚ã«ã€ŒğŸ“± ãƒ•ãƒªãƒƒã‚¯å…¥åŠ›ã€ãƒœã‚¿ãƒ³ã§åˆ‡ã‚Šæ›¿ãˆ
# IMEã§å®Ÿéš›ã«ã²ã‚‰ãŒãªã‚’å…¥åŠ›
# ã‚­ãƒ¼ãƒ­ã‚°ãŒæ­£ã—ãè¨˜éŒ²ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
# ã‚¹ã‚³ã‚¢è¨ˆç®—ãŒæ­£ã—ã„ã‹ç¢ºèª
```

### ãƒœãƒƒãƒˆæ¤œå‡ºãƒ†ã‚¹ãƒˆ
- ã‚³ãƒ³ã‚½ãƒ¼ãƒ«é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã§ã€äººå·¥çš„ã«ã‚­ãƒ¼ãƒ­ã‚°ã‚’ä¿®æ­£ã—ã¦é€ä¿¡
- ã€ŒBot detected: ...ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§æ¤œå‡ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª

## äº’æ›æ€§

- âœ… æ—¢å­˜ã®åŠè§’å…¥åŠ›ãƒ¢ãƒ¼ãƒ‰ã«ã¯å½±éŸ¿ãªã—
- âœ… ä¸¡ãƒ¢ãƒ¼ãƒ‰ã‚’åŒä¸€ã‚»ãƒƒã‚·ãƒ§ãƒ³å†…ã§åˆ‡ã‚Šæ›¿ãˆå¯èƒ½
- âœ… ã‚µãƒ¼ãƒãƒ¼å´ã§è‡ªå‹•æ¤œå‡ºãƒ»å‡¦ç†
